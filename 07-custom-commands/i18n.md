---
name: i18n
description: "Internationalization Agent - Manage translations, extract strings, validate locales, and ensure i18n best practices"
category: localization
complexity: enhanced
mcp-servers: [serena]
personas: [i18n-specialist]
---

# /i18n - Internationalization Agent

> **Context Framework Note**: This behavioral instruction activates when users type `/i18n`. It coordinates translation management, string extraction, locale validation, and i18n best practices.

## Triggers
- Translation string extraction
- Locale file management
- Missing translation detection
- Translation validation and QA
- RTL/pluralization support

## Context Trigger Pattern
```
/i18n [action] [--locale <locale>] [--fix] [--report]
```

### Actions
| Action | Purpose |
|--------|---------|
| `scan` | Find hardcoded strings (default) |
| `extract` | Extract strings to locale files |
| `validate` | Check translation completeness |
| `sync` | Sync translations across locales |
| `add` | Add new locale support |
| `migrate` | Convert legacy i18n format |

### Options
| Flag | Effect |
|------|--------|
| `--locale <code>` | Target locale (en, bg, de, etc.) |
| `--fix` | Auto-fix issues with confirmation |
| `--report` | Generate i18n status report |
| `--missing` | Show only missing translations |
| `--unused` | Find unused translation keys |

## Behavioral Flow

### 1. Project Analysis
```yaml
Detect Framework:
  - Laravel (lang/, __(), @lang)
  - React (i18next, react-intl)
  - Vue (vue-i18n)
  - Next.js (next-i18next)

Identify:
  - Locale file locations
  - Default/fallback locale
  - Supported locales
  - Translation format (PHP, JSON, YAML)
```

### 2. String Extraction (`/i18n scan`)
```yaml
Hardcoded String Detection:
  1. Scan views/templates for text
  2. Identify user-facing strings
  3. Exclude technical strings (IDs, classes)
  4. Group by file/component

Patterns to Find:
  Laravel:
    - Text in Blade templates
    - Strings in controllers
    - Validation messages
    - Email content

  JavaScript:
    - JSX text content
    - Alert/confirm messages
    - Form labels/placeholders
    - Error messages
```

### 3. Translation Validation (`/i18n validate`)
```yaml
Completeness Check:
  - Compare keys across all locales
  - Find missing translations
  - Detect untranslated (same as source)
  - Check placeholder consistency

Quality Check:
  - Key naming conventions
  - Placeholder formatting (:name vs {name})
  - HTML in translations (security)
  - Hardcoded values in translations

Pluralization:
  - Plural rules correct for locale
  - All plural forms present
  - Zero/one/many variations
```

### 4. Locale Sync (`/i18n sync`)
```yaml
Sync Process:
  1. Use primary locale as source of truth
  2. Add missing keys to other locales
  3. Mark new keys as "needs translation"
  4. Remove orphaned keys (optional)
  5. Sort keys alphabetically

Conflict Resolution:
  - New in source → Add to targets
  - Removed from source → Flag for review
  - Changed in source → Mark as stale
```

### 5. Common Patterns

#### Laravel i18n
```yaml
File Structure:
  lang/
  ├── en/
  │   ├── messages.php
  │   ├── validation.php
  │   └── auth.php
  ├── bg/
  │   └── ...
  └── en.json  # JSON translations

Usage:
  - __('messages.welcome')
  - @lang('messages.welcome')
  - trans_choice('messages.items', $count)
  - {{ __('Hello :name', ['name' => $user]) }}

Best Practices:
  - Group by feature (messages, auth, orders)
  - Use dot notation for nesting
  - Keep keys descriptive
  - Use placeholders, not concatenation
```

#### React/Vue i18n
```yaml
File Structure:
  locales/
  ├── en.json
  ├── bg.json
  └── de.json

Usage (i18next):
  - t('welcome')
  - t('greeting', { name: user.name })
  - <Trans i18nKey="intro">...</Trans>

Usage (vue-i18n):
  - $t('welcome')
  - {{ $t('greeting', { name }) }}
  - $tc('items', count)
```

## String Extraction Helpers

### Laravel Blade Extraction
```yaml
Find Patterns:
  - >Text</              # Tag content
  - placeholder="Text"   # Attributes
  - title="Text"         # Title attrs
  - alt="Text"           # Alt text
  - @if conditions       # Skip these

Generate:
  - {{ __('namespace.key') }}
  - Add to lang/en/namespace.php
```

### JSX Extraction
```yaml
Find Patterns:
  - >Text<               # Element content
  - placeholder="Text"   # Props
  - aria-label="Text"    # Accessibility
  - title="Text"         # Title props

Generate:
  - {t('namespace.key')}
  - Add to locales/en.json
```

## Output Format

### Scan Results
```
i18n Scan: [scope] | Strings Found: XX
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Hardcoded Strings: 45
Already Translated: 230
Missing Translations: 12

By File:
  views/orders/index.blade.php    8 hardcoded
  views/users/profile.blade.php   5 hardcoded
  components/Header.vue           3 hardcoded

Top Priority (user-facing):
1. "Welcome back" → __('messages.welcome_back')
2. "Submit Order" → __('orders.submit')
3. "Invalid email" → __('validation.email')
```

### Validation Report
```
i18n Validation: [locales] | Status: [OK/ISSUES]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Locales: en (base), bg, de

Coverage:
  en: 100% (250/250 keys)
  bg: 94% (235/250 keys) - 15 missing
  de: 88% (220/250 keys) - 30 missing

Issues:
  [WARN] bg: 15 missing keys
  [WARN] de: 30 missing keys
  [INFO] 5 unused keys detected
  [INFO] 3 keys same as English (possibly untranslated)

Missing in bg:
  - orders.status.pending
  - orders.status.shipped
  - validation.custom.phone
  ...
```

### Translation Status Matrix
```
Key                    | en | bg | de | fr |
-----------------------|----|----|----|----|
messages.welcome       | ✓  | ✓  | ✓  | ✗  |
messages.goodbye       | ✓  | ✓  | ✗  | ✗  |
orders.submit          | ✓  | ✓  | ✓  | ✓  |
validation.email       | ✓  | ✗  | ✗  | ✗  |
```

## Examples

```bash
# Scan for hardcoded strings
/i18n scan

# Extract and create translation keys
/i18n extract --locale en

# Validate all translations
/i18n validate

# Check specific locale
/i18n validate --locale bg --missing

# Sync translations from English
/i18n sync --locale bg

# Add new locale
/i18n add --locale de

# Find unused translation keys
/i18n validate --unused

# Generate i18n report
/i18n validate --report

# Auto-fix missing keys (add placeholders)
/i18n sync --fix
```

## i18n Best Practices

```yaml
Key Naming:
  Good:
    - orders.status.pending
    - validation.email.invalid
    - buttons.submit

  Bad:
    - string1, string2
    - welcomeMessage (inconsistent)
    - orders_pending (mixed separators)

String Handling:
  Good:
    - __('Hello :name', ['name' => $user])
    - t('items', { count: 5 })

  Bad:
    - __('Hello ') . $user  # Concatenation
    - "Hello " + name       # Concatenation

Pluralization:
  Good:
    - trans_choice('{0} No items|{1} One item|[2,*] :count items', $count)
    - t('items', { count }) with plural rules

  Bad:
    - $count == 1 ? 'item' : 'items'  # Manual plural
```

## Framework-Specific Commands

### Laravel
```bash
# Publish language files
php artisan lang:publish

# Generate missing keys
php artisan translatable:export en

# Using Laravel Lang (package)
composer require laravel-lang/common
php artisan lang:add bg
php artisan lang:update
```

### React/Next.js
```bash
# i18next extraction
npx i18next-parser

# Check missing
npx i18next-parser --fail-on-warnings
```

## i18n Checklist

```yaml
Setup:
  - [ ] i18n library configured
  - [ ] Default locale set
  - [ ] Fallback locale defined
  - [ ] Locale detection working

Content:
  - [ ] All user-facing strings extracted
  - [ ] No hardcoded text in templates
  - [ ] Placeholders used (not concatenation)
  - [ ] Pluralization handled

Quality:
  - [ ] All locales complete
  - [ ] Keys follow naming convention
  - [ ] No HTML in translations
  - [ ] Date/number formatting localized

Testing:
  - [ ] Each locale renders correctly
  - [ ] RTL languages supported (if needed)
  - [ ] Special characters display
  - [ ] Long translations don't break UI
```

## Boundaries

**Will:**
- Scan code for hardcoded strings
- Extract strings to locale files
- Validate translation completeness
- Sync translations across locales
- Generate i18n status reports

**Won't:**
- Actually translate content (suggest using translation services)
- Modify existing translations without confirmation
- Remove translations without review
- Change locale file structure without approval
- Override user's i18n configuration
